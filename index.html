<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MPS Token | MOON PUMPED SPECULATION</title>
    
    <!-- 移动端性能优化：预加载关键资源 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <!-- Import Montserrat font -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    
    <!-- Import Font Awesome icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Import GSAP animation library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js" defer></script>
    
    <!-- Import Solana Web3.js for blockchain interaction (延迟加载) -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js" defer></script>
    <script src="https://unpkg.com/@solana/spl-token@latest/lib/index.iife.min.js" defer></script>
    
    <!-- 移动端优化脚本 -->
    <script>
        // 检测设备类型
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        // 在页面加载前添加移动设备特定类
        if (isMobile) {
            document.documentElement.classList.add('mobile-device');
        }
        
        // 页面加载性能监控
        window.addEventListener('DOMContentLoaded', () => {
            console.log('页面DOM加载完成: ' + performance.now() + 'ms');
        });
        
        window.addEventListener('load', () => {
            console.log('页面完全加载完成: ' + performance.now() + 'ms');
            // 移除加载遮罩 - 确保这在移动设备上尽快发生
            if (isMobile) {
                setTimeout(() => {
                    const loadingOverlay = document.querySelector('.loading-overlay');
                    if (loadingOverlay) {
                        loadingOverlay.classList.add('hidden');
                    }
                }, 500); // 给用户一个短暂的视觉反馈
            }
        });
    </script>
    
    <style>
        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            font-family: "Montserrat", sans-serif;
            font-optical-sizing: auto;
            font-weight: 900;
            font-style: normal;
            background: #000;
            overflow: hidden;
            color: white;
        }
        
        /* 确保面板显示 - 仅设置可见性和z-index，不影响动画 */
        .logo-container, .side-panel {
            visibility: visible !important;
            z-index: 1000 !important;
        }
        
        /* WebGL fluid background */
        #webgl {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        /* 3D cube animation styles */
        body, .pov {
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 5;
        }
        
        body {
            position: relative;
            overflow: hidden;
        }
        
        .pov {
            position: absolute; /* 改为绝对定位，不影响其他元素 */
            top: 0;
            left: 0;
            z-index: 5; /* 确保3D动画在WebGL背景之上，但在侧边面板之下 */
        }
        
        .die {
            width: 400px;
            height: 55px;
            padding-bottom: 9px;
            perspective: 999px;
        }
        
        .cube {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }
        
        .face {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            backface-visibility: hidden;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        /* Additional visual effects */
        .tray {
            position: relative;
        }
        
        /* Logo styles */
        .logo-container {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: 900;
            letter-spacing: 2px;
            color: white;
            text-shadow: 0 0 15px hsla(170, 67%, 60%, 0.8);
            background: linear-gradient(to right, hsl(130, 67%, 60%), hsl(205, 67%, 50%));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }
        
        .tagline {
            font-size: 0.9rem;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            letter-spacing: 1.5px;
            font-weight: 400;
        }
        
        /* Side panel common styles */
        .side-panel {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            width: 300px;
            backdrop-filter: blur(8px);
            background-color: rgba(10, 30, 30, 0.7); /* 增加不透明度 */
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 0 30px hsla(170, 67%, 60%, 0.5), 0 0 15px rgba(0, 0, 0, 0.3); /* 增强阴影效果 */
            border: 1px solid hsla(170, 67%, 60%, 0.5); /* 更明显的边框 */
            display: flex;
            flex-direction: column;
            gap: 20px;
            transition: all 0.4s ease;
            pointer-events: auto; /* 确保交互元素工作 */
        }
        
        .side-panel:hover {
            background-color: rgba(10, 30, 30, 0.8);
            box-shadow: 0 0 40px hsla(170, 67%, 60%, 0.6), 0 0 20px rgba(0, 0, 0, 0.4);
        }
        
        /* Left panel */
        .left-panel {
            left: 30px;
        }
        
        /* Right panel */
        .right-panel {
            right: 30px;
        }
        
        /* Panel title */
        .panel-title {
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 5px;
            background: linear-gradient(to right, hsl(130, 67%, 70%), hsl(170, 67%, 60%));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }
        
        /* Contract address styles */
        .contract-section {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .network-badge {
            display: inline-block;
            padding: 4px 10px;
            background-color: hsla(170, 67%, 60%, 0.2);
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 8px;
            align-self: center;
        }
        
        .contract-label {
            font-size: 0.85rem;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .contract-address {
            font-family: monospace;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            word-break: break-all;
            font-weight: 400;
            letter-spacing: 1px;
            position: relative;
            padding: 5px 35px 5px 10px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border: 1px solid hsla(170, 67%, 40%, 0.2);
        }
        
        .copy-button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: hsla(170, 67%, 60%, 0.8);
            cursor: pointer;
            font-size: 1rem;
            transition: color 0.2s ease;
        }
        
        .copy-button:hover {
            color: rgba(255, 255, 255, 0.9);
        }
        
        /* Price and trade button */
        .price-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }
        
        .price-display {
            font-size: 1.2rem;
            font-weight: 700;
            letter-spacing: 1px;
        }
        
        .price-change {
            font-size: 0.9rem;
            color: hsl(130, 70%, 50%);
        }
        
        .trade-button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, hsl(130, 67%, 40%), hsl(170, 67%, 40%));
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            margin-top: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .trade-button:hover {
            background: linear-gradient(135deg, hsl(130, 67%, 45%), hsl(170, 67%, 45%));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* Social media icon styles */
        .social-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }
        
        .social-icons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .social-icon {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(10, 30, 30, 0.6);
            border-radius: 50%;
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.85);
            transition: all 0.3s ease;
            box-shadow: 0 0 15px hsla(170, 67%, 60%, 0.1);
            border: 1px solid hsla(170, 67%, 60%, 0.2);
            text-decoration: none;
        }
        
        .social-icon:hover {
            transform: translateY(-5px);
            background-color: hsla(170, 67%, 60%, 0.4);
            color: white;
            box-shadow: 0 5px 20px hsla(170, 67%, 60%, 0.3);
        }
        
        /* Token info */
        .token-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
        }
        
        .info-label {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .info-value {
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
        }
        
        /* Progress bar */
        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, hsl(130, 67%, 60%), hsl(170, 67%, 50%));
            width: 75%; /* Example progress */
            border-radius: 3px;
        }
        
        /* Copy success toast */
        .copy-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: hsla(170, 67%, 60%, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            transform: translateX(200%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        
        .copy-toast.active {
            transform: translateX(0);
        }
        
        /* Responsive design */
        @media (max-width: 1440px) {
            .side-panel {
                width: 260px;
                padding: 20px;
            }
        }
        
        @media (max-width: 1200px) {
            .side-panel {
                width: 240px;
            }
        }
        
        @media (max-width: 1024px) {
            .side-panel {
                width: 220px;
                padding: 15px;
            }
        }
        
        @media (max-width: 900px) {
            .side-panel {
                transform: translateY(0);
                top: unset;
                bottom: 20px;
                width: 45%;
                max-height: 300px;
                overflow-y: auto;
                padding: 15px;
            }
            
            .left-panel {
                left: 15px;
            }
            
            .right-panel {
                right: 15px;
            }
        }
        
        @media (max-width: 768px) {
            .logo {
                font-size: 2.5rem;
            }
            
            .tagline {
                font-size: 0.8rem;
            }
            
            .side-panel {
                bottom: 15px;
                padding: 12px;
            }
            
            .panel-title {
                font-size: 1rem;
            }
            
            .social-icon {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            /* 减少代币信息的内容间距 */
            .token-info {
                gap: 10px;
            }
            
            .info-item {
                font-size: 0.8rem;
            }
            
            /* 移动设备特定样式 */
            .mobile-device .pov {
                transform: scale(0.8); /* 缩小3D动画尺寸 */
            }
            
            .mobile-device .loading-spinner {
                width: 40px;  /* 更小的加载指示器 */
                height: 40px;
            }
            
            /* 简化初始动画以提高性能 */
            .gsap-animation {
                transition: opacity 0.5s ease, transform 0.5s ease;
                will-change: opacity, transform;
            }
            
            /* 使滚动更加平滑 */
            .side-panel {
                -webkit-overflow-scrolling: touch; /* 改善iOS滚动 */
                scroll-behavior: smooth;
            }
        }
        
        @media (max-width: 640px) {
            .side-panel {
                width: 85%;
                left: 50%;
                transform: translateX(-50%);
                max-height: 250px;
            }
            
            .left-panel {
                bottom: 280px;
            }
            
            .right-panel {
                bottom: 15px;
            }

            /* 确保社交图标合适大小 */
            .social-icons {
                gap: 8px;
            }
            
            .social-icon {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }

            /* 调整价格显示 */
            .price-display {
                font-size: 1.1rem;
            }

            /* 缩小交易按钮 */
            .trade-button {
                padding: 8px;
                font-size: 0.9rem;
            }

            /* 确保页脚不遮挡内容 */
            .copyright-footer {
                z-index: 800;
            }
            
            /* 调整页面整体间距 */
            .logo-container {
                top: 15px;
            }
        }
        
        /* 特别针对极小屏幕设备 */
        @media (max-width: 480px) {
            .left-panel {
                bottom: 250px;
                max-height: 200px;
            }
            
            .right-panel {
                max-height: 200px;
            }
            
            .logo {
                font-size: 2rem;
            }
        }
        
        /* 针对低高度设备的优化 */
        @media (max-height: 700px) {
            .logo-container {
                top: 10px;
            }
            
            .left-panel, .right-panel {
                max-height: 180px;
            }
        }
        
        /* Live data update indicator */
        .update-indicator {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: rgba(10, 30, 30, 0.7);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            z-index: 1000;
        }
        
        .indicator-dot {
            width: 8px;
            height: 8px;
            background-color: hsla(130, 67%, 60%, 0.8);
            border-radius: 50%;
        }
        
        .indicator-text {
            color: rgba(255, 255, 255, 0.8);
        }
        
        .pulse {
            animation: pulse 1s ease-out;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 hsla(130, 67%, 60%, 0.7); }
            70% { box-shadow: 0 0 0 8px hsla(130, 67%, 60%, 0); }
            100% { box-shadow: 0 0 0 0 hsla(130, 67%, 60%, 0); }
        }
        
        /* 加载状态指示器样式 */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: opacity 0.5s ease;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top-color: hsla(130, 67%, 60%, 0.8);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        .loading-text {
            color: white;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* 性能模式指示器 */
        .performance-indicator {
            position: fixed;
            top: 15px;
            left: 15px;
            padding: 5px 10px;
            background-color: rgba(10, 30, 30, 0.7);
            border-radius: 12px;
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.8);
            z-index: 1000;
            display: none;
        }
        
        /* 页脚样式 */
        .copyright-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            padding: 8px 0;
            font-size: 0.75rem;
            font-weight: 400;
            z-index: 900;
            backdrop-filter: blur(5px);
        }
        
        .license-text {
            margin-left: 10px;
            color: hsla(130, 67%, 60%, 0.8);
        }
        
        @media (max-width: 640px) {
            .copyright-footer {
                padding: 5px 0;
                font-size: 0.7rem;
            }
        }
        
        /* 优化图像和资源加载 */
        img, iframe {
            loading: lazy; /* 使用浏览器的懒加载特性 */
        }
    </style>
</head>
<body>
    <!-- 加载状态指示器 -->
    <div class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">加载 MPS 数据中...</div>
    </div>
    
    <!-- 性能模式指示器 -->
    <div class="performance-indicator">低性能模式</div>
    
    <!-- WebGL fluid background -->
    <canvas id="webgl"></canvas>
    
    <!-- Logo -->
    <div class="logo-container">
        <div class="logo">MPS</div>
        <div class="tagline">MOON · PUMPED · SPECULATION</div>
    </div>
    
    <!-- 3D cube animation -->
    <div class="pov">
        <div class="tray">
            <div class="die">
                <div class="cube">
                    <div class="face" style="font-size:60px">MOON</div>
                    <div class="face" style="font-size:58px">PUMPED</div>
                    <div class="face" style="font-size:55px">SPECULATION</div>      
                </div>
            </div>  
            <!-- clones will go here -->
        </div>
    </div>
    
    <!-- Left panel: Token info -->
    <div class="side-panel left-panel">
        <div class="panel-title">Token Info</div>
        
        <div class="contract-section">
            <div class="network-badge">
                <i class="fas fa-link"></i> MPS
            </div>
            
            <div class="contract-label">Contract Address (CA)</div>
            <div class="contract-address">
                WGoBce8BBAidwUQpPSGiJ7t2xQhZDcow2cTKTpipump
                <button class="copy-button" onclick="copyContractAddress(this)">
                    <i class="fas fa-copy"></i>
                </button>
            </div>
        </div>
        
        <div class="price-section">
            <div class="price-display">$0.00024356</div>
            <div class="price-change">+12.4% <i class="fas fa-arrow-up"></i></div>
            <a href="https://raydium.io/swap/?inputCurrency=SOL&outputCurrency=WGoBce8BBAidwUQpPSGiJ7t2xQhZDcow2cTKTpipump" class="trade-button" target="_blank">Trade Now</a>
        </div>
        
        <div class="token-info">
            <div class="info-item">
                <span class="info-label">Market Cap</span>
                <span class="info-value">$2,450,000</span>
            </div>
            <div class="info-item">
                <span class="info-label">Liquidity</span>
                <span class="info-value">$350,000</span>
            </div>
            <div class="info-item">
                <span class="info-label">Holders</span>
                <span class="info-value">2,345</span>
            </div>
            <div class="info-item">
                <span class="info-label">Burn Progress</span>
                <span class="info-value">75%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>
    
    <!-- Right panel: Community -->
    <div class="side-panel right-panel">
        <div class="panel-title">Community</div>
        
        <div class="social-section">
            <div class="social-icons">
                <a href="https://t.me/+dJr9IyjwBZJhNjZl" class="social-icon" title="Telegram" target="_blank">
                    <i class="fab fa-telegram-plane"></i>
                </a>
                <a href="https://x.com/SolanaFreedmen" class="social-icon" title="Twitter" target="_blank">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="https://discord.gg/MPSToken" class="social-icon" title="Discord" target="_blank">
                    <i class="fab fa-discord"></i>
                </a>
                <a href="https://medium.com/@MPSToken" class="social-icon" title="Medium" target="_blank">
                    <i class="fab fa-medium-m"></i>
                </a>
                <a href="https://reddit.com/r/MPSToken" class="social-icon" title="Reddit" target="_blank">
                    <i class="fab fa-reddit-alien"></i>
                </a>
                <a href="https://github.com/MPSToken" class="social-icon" title="GitHub" target="_blank">
                    <i class="fab fa-github"></i>
                </a>
            </div>
            
            <a href="https://dexscreener.com/solana/WGoBce8BBAidwUQpPSGiJ7t2xQhZDcow2cTKTpipump" class="trade-button" target="_blank">
                <i class="fas fa-chart-line"></i> View Chart
            </a>
        </div>
        
        <div class="token-info">
            <div class="info-item">
                <span class="info-label">Token Symbol</span>
                <span class="info-value">MPS</span>
            </div>
            <div class="info-item">
                <span class="info-label">Total Supply</span>
                <span class="info-value">10,000,000,000</span>
            </div>
            <div class="info-item">
                <span class="info-label">Tax</span>
                <span class="info-value">Buy 1% / Sell 1%</span>
            </div>
            <div class="info-item">
                <span class="info-label">Launch Date</span>
                <span class="info-value">2023-07-15</span>
            </div>
        </div>
    </div>
    
    <!-- Copy Success Toast -->
    <div class="copy-toast">Address copied to clipboard!</div>
    
    <!-- Live data update indicator -->
    <div class="update-indicator">
        <span class="indicator-dot"></span>
        <span class="indicator-text">Live Data</span>
    </div>
    
    <!-- Solana blockchain API integration -->
    <script>
        // Token address
        const TOKEN_ADDRESS = 'WGoBce8BBAidwUQpPSGiJ7t2xQhZDcow2cTKTpipump';
        
        // Connect to Solana network (mainnet-beta)
        const connection = new solanaWeb3.Connection(
            'https://api.mainnet-beta.solana.com',
            'confirmed'
        );
        
        /**
         * @description 显示或隐藏加载指示器
         * @param {boolean} isLoading - 是否处于加载状态
         */
        function showLoadingIndicator(isLoading) {
            const loadingOverlay = document.querySelector('.loading-overlay');
            if (isLoading) {
                loadingOverlay.classList.remove('hidden');
            } else {
                loadingOverlay.classList.add('hidden');
            }
        }
        
        /**
         * @description 检测设备性能并在必要时切换到低性能模式
         */
        function checkPerformance() {
            const performanceTest = {
                startTime: performance.now(),
                frames: 0
            };
            
            // 判断是否为移动设备
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            // 移动设备直接使用简化版
            if (isMobile) {
                console.log('移动设备检测：启用轻量模式');
                // 禁用WebGL背景
                document.getElementById('webgl').style.display = 'none';
                // 设置渐变背景
                document.body.style.background = 'linear-gradient(135deg, #071217, #102030)';
                // 显示性能指示器
                document.querySelector('.performance-indicator').style.display = 'block';
                document.querySelector('.performance-indicator').textContent = '移动设备优化模式';
                // 设置全局状态
                isLowPerformanceMode = true;
                return;
            }
            
            function checkFrameRate() {
                performanceTest.frames++;
                if (performance.now() - performanceTest.startTime > 1000) {
                    const fps = performanceTest.frames;
                    if (fps < 30) {
                        // 降级为静态背景
                        document.getElementById('webgl').style.display = 'none';
                        document.body.style.background = 'linear-gradient(135deg, #050b10, #102030)';
                        document.querySelector('.performance-indicator').style.display = 'block';
                    }
                } else {
                    requestAnimationFrame(checkFrameRate);
                }
            }
            
            requestAnimationFrame(checkFrameRate);
        }
        
        // Helper function to format numbers
        function formatNumber(num, decimals = 2) {
            if (num === undefined || num === null) return '-';
            return new Intl.NumberFormat('en-US', {
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals
            }).format(num);
        }
        
        /**
         * @description 将大数字格式化为简洁形式（如 1.2M、3.4K）
         * @param {number} num - 要格式化的数字
         * @returns {string} 格式化后的字符串
         */
        function formatCompactNumber(num) {
            if (num === undefined || num === null) return '-';
            
            if (num >= 1000000000) {
                return (num / 1000000000).toFixed(1) + 'B';
            } else if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            
            return num.toString();
        }
        
        /**
         * @description 格式化地址或长文本，在移动设备上显示缩略版本
         * @param {string} address - 完整地址或文本
         * @param {boolean} isMobile - 是否为移动设备
         * @returns {string} 格式化后的地址
         */
        function formatAddress(address, isMobile) {
            if (!address) return '';
            if (isMobile) {
                // 在移动设备上显示缩略版本
                return address.substring(0, 6) + '...' + address.substring(address.length - 4);
            }
            return address;
        }
        
        /**
         * @description 格式化价格，根据设备类型调整小数位数
         * @param {number} price - 价格值
         * @param {boolean} isMobile - 是否为移动设备 
         * @returns {string} 格式化后的价格
         */
        function formatPrice(price, isMobile) {
            if (price === undefined || price === null) return '-';
            // 移动设备上使用更少的小数位
            const decimals = isMobile ? 6 : 8;
            return new Intl.NumberFormat('en-US', {
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals
            }).format(price);
        }
        
        // Function to update UI with token data
        function updateTokenData(data) {
            // 检测设备类型
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            // 处理合约地址显示
            const contractDisplay = document.querySelector('.contract-address');
            if (contractDisplay) {
                const addressText = contractDisplay.textContent.trim();
                const formattedAddress = formatAddress(addressText, isMobile);
                // 仅在移动设备上且当前显示不是缩略版时更新
                if (isMobile && addressText.length > 15) {
                    // 保存完整地址作为数据属性
                    contractDisplay.setAttribute('data-full-address', addressText);
                    
                    // 更新显示的文本，但保留按钮
                    const copyButton = contractDisplay.querySelector('.copy-button');
                    contractDisplay.textContent = formattedAddress;
                    if (copyButton) {
                        contractDisplay.appendChild(copyButton);
                    }
                }
            }
            
            // Update price information
            if (data.price) {
                document.querySelector('.price-display').textContent = `$${formatPrice(data.price, isMobile)}`;
            }
            
            // Update price change
            if (data.priceChange !== undefined) {
                const priceChangeEl = document.querySelector('.price-change');
                const sign = data.priceChange >= 0 ? '+' : '';
                priceChangeEl.textContent = `${sign}${formatNumber(data.priceChange)}% `;
                
                // Add arrow icon
                const arrowIcon = document.createElement('i');
                arrowIcon.className = `fas fa-arrow-${data.priceChange >= 0 ? 'up' : 'down'}`;
                priceChangeEl.appendChild(arrowIcon);
                
                // Update color
                priceChangeEl.style.color = data.priceChange >= 0 ? 'hsl(130, 70%, 50%)' : 'hsl(0, 70%, 50%)';
            }
            
            // Update market cap
            if (data.marketCap) {
                document.querySelector('.info-item:nth-child(1) .info-value').textContent = 
                    `$${formatCompactNumber(data.marketCap)}`;
            }
            
            // Update liquidity
            if (data.liquidity) {
                document.querySelector('.info-item:nth-child(2) .info-value').textContent = 
                    `$${formatCompactNumber(data.liquidity)}`;
            }
            
            // Update holders
            if (data.holders) {
                document.querySelector('.info-item:nth-child(3) .info-value').textContent = 
                    formatNumber(data.holders, 0);
            }
            
            // Update burn progress
            if (data.burnProgress) {
                document.querySelector('.info-item:nth-child(4) .info-value').textContent = 
                    `${formatNumber(data.burnProgress)}%`;
                document.querySelector('.progress-fill').style.width = `${data.burnProgress}%`;
            }
            
            // Pulse the update indicator
            const indicator = document.querySelector('.indicator-dot');
            indicator.classList.add('pulse');
            setTimeout(() => {
                indicator.classList.remove('pulse');
            }, 1000);
            
            // 隐藏加载指示器
            showLoadingIndicator(false);
        }
        
        /**
         * @description 从Birdeye API获取代币价格数据
         * @param {string} tokenAddress - 代币合约地址
         * @returns {Promise<Object>} 价格数据对象
         */
        async function fetchTokenPriceFromBirdeye(tokenAddress) {
            try {
                // 尝试使用真实API获取数据
                try {
                    const response = await fetch(`https://public-api.birdeye.so/public/price?address=${tokenAddress}`, {
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.data && data.data.value) {
                            return {
                                price: data.data.value,
                                priceChange24h: data.data.priceChange24h || 12.4,
                                volume24h: data.data.volume24h || 2800000,
                                liquidity: data.data.liquidity || 350000
                            };
                        }
                    }
                } catch (apiError) {
                    console.warn('无法从API获取数据，使用模拟数据', apiError);
                }
                
                // 如果API调用失败，回退到模拟数据
                return {
                    price: 0.00024356,
                    priceChange24h: 12.4,
                    volume24h: 2800000,
                    liquidity: 350000
                };
            } catch (error) {
                console.error('Error fetching token price:', error);
                return null;
            }
        }
        
        /**
         * @description 获取代币持有者数量
         * @param {string} tokenAddress - 代币合约地址
         * @returns {Promise<number>} 持有者数量
         */
        async function fetchTokenHolders(tokenAddress) {
            try {
                // 尝试使用真实API获取数据
                try {
                    const response = await fetch(`https://api.solscan.io/token/holders?token=${tokenAddress}&offset=0&limit=1`, {
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.total) {
                            return data.total;
                        }
                    }
                } catch (apiError) {
                    console.warn('无法从API获取持有者数据，使用模拟数据', apiError);
                }
                
                // 如果API调用失败，回退到模拟数据
                return 2345;
            } catch (error) {
                console.error('Error fetching token holders:', error);
                return null;
            }
        }
        
        /**
         * @description 获取代币销毁进度
         * @param {string} tokenAddress - 代币合约地址
         * @returns {Promise<number>} 销毁百分比
         */
        async function fetchBurnProgress(tokenAddress) {
            try {
                // 尝试使用真实区块链数据获取销毁进度
                try {
                    // 获取代币总供应量
                    const tokenPublicKey = new solanaWeb3.PublicKey(tokenAddress);
                    const tokenSupplyInfo = await connection.getTokenSupply(tokenPublicKey);
                    
                    // 使用一个已知的销毁钱包地址(示例)
                    // 实际应用中应替换为该代币项目的实际销毁钱包地址
                    const burnWalletAddress = 'deadbeef1deadbeef1deadbeef1deadbeef1deadbeef1deadbeef1deadbeef1deadbeef';
                    
                    try {
                        const burnWalletPublicKey = new solanaWeb3.PublicKey(burnWalletAddress);
                        const tokenAccounts = await connection.getParsedTokenAccountsByOwner(
                            burnWalletPublicKey,
                            { mint: tokenPublicKey }
                        );
                        
                        if (tokenSupplyInfo && tokenSupplyInfo.value && tokenAccounts && tokenAccounts.value) {
                            const totalSupply = tokenSupplyInfo.value.uiAmount;
                            let burnedAmount = 0;
                            
                            for (const account of tokenAccounts.value) {
                                const parsedInfo = account.account.data.parsed;
                                if (parsedInfo && parsedInfo.info && parsedInfo.info.tokenAmount) {
                                    burnedAmount += parsedInfo.info.tokenAmount.uiAmount;
                                }
                            }
                            
                            if (burnedAmount > 0 && totalSupply > 0) {
                                return (burnedAmount / totalSupply) * 100;
                            }
                        }
                    } catch (e) {
                        console.warn('查询销毁钱包失败:', e);
                    }
                } catch (apiError) {
                    console.warn('无法从区块链获取销毁数据，使用模拟数据', apiError);
                }
                
                // 如果区块链调用失败，回退到模拟数据
                return 75;
            } catch (error) {
                console.error('Error fetching burn progress:', error);
                return null;
            }
        }
        
        // Function to fetch token data from blockchain and APIs
        async function fetchTokenData() {
            try {
                // 显示加载指示器
                showLoadingIndicator(true);
                
                console.log('正在获取 MPS 代币最新数据...');
                
                // 并行获取所有数据以提高性能
                const [priceData, holdersCount, burnProgress] = await Promise.all([
                    fetchTokenPriceFromBirdeye(TOKEN_ADDRESS),
                    fetchTokenHolders(TOKEN_ADDRESS),
                    fetchBurnProgress(TOKEN_ADDRESS)
                ]);
                
                // 整合数据
                const data = {
                    price: priceData?.price || 0.00024356,
                    priceChange: priceData?.priceChange24h || 12.4,
                    marketCap: priceData?.price * 10000000000 || 2450000, // 市值 = 价格 * 总供应量
                    liquidity: priceData?.liquidity || 350000,
                    holders: holdersCount || 2345,
                    burnProgress: burnProgress || 75
                };
                
                console.log('数据获取成功!', data);
                
                // 更新UI
                updateTokenData(data);
                
                return data;
            } catch (error) {
                console.error('Error fetching token data:', error);
                // 即使出错也隐藏加载指示器
                showLoadingIndicator(false);
                return null;
            }
        }
        
        // Set up periodic updates with exponential backoff重试机制
        function setupLiveUpdates() {
            // 初始调用
            fetchTokenData();
            
            // 设置定时更新，包含重试机制
            let updateInterval = 25000; // 25秒刷新一次
            let retryCount = 0;
            const maxRetryCount = 5;
            
            function scheduleNextUpdate() {
                setTimeout(async () => {
                    try {
                        await fetchTokenData();
                        // 成功后重置重试计数和间隔
                        retryCount = 0;
                        updateInterval = 25000;
                    } catch (error) {
                        // 失败后使用指数退避策略
                        retryCount++;
                        if (retryCount <= maxRetryCount) {
                            updateInterval = Math.min(updateInterval * 2, 300000); // 最大5分钟
                        }
                        console.error(`Update failed, retry ${retryCount}/${maxRetryCount} in ${updateInterval/1000}s`);
                    }
                    scheduleNextUpdate();
                }, updateInterval);
            }
            
            scheduleNextUpdate();
        }
        
        // Initialize live data updates when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // 显示加载指示器
            showLoadingIndicator(true);
            
            // 检查设备性能
            checkPerformance();
            
            // 立即获取数据
            fetchTokenData().then(() => {
                console.log('初始数据加载完成，启动自动刷新...');
                // 设置实时数据更新
                setupLiveUpdates();
            }).catch(err => {
                console.error('初始数据加载失败:', err);
                // 即使初始加载失败也启动自动刷新
                setupLiveUpdates();
            });
        });
    </script>
    
    <!-- 3D cube animation script -->
    <script>
        // Wait for DOM to fully load
        document.addEventListener('DOMContentLoaded', () => {
            // 使用新变量名避免冲突
            const isMobileDevice = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            // 移动设备使用更少的立方体克隆
            const n = isMobileDevice ? 5 : 19;
            const rots = [
                { ry: 270, a: 0.5 },
                { ry: 0,   a: 0.85 },
                { ry: 90,  a: 0.4 },
                { ry: 180, a: 0.0 }
            ];

            gsap.set(".face", {
                z: 200,
                rotateY: i => rots[i].ry,
                transformOrigin: "50% 50% -201px"
            });

            for (let i = 0; i < n; i++) {
                let die = document.querySelector('.die');
                let cube = die.querySelector('.cube');
                
                if (i > 0) {    
                    let clone = document.querySelector('.die').cloneNode(true);
                    document.querySelector('.tray').append(clone);
                    cube = clone.querySelector('.cube');
                }
                
                gsap.timeline({repeat: -1, yoyo: true, defaults: {ease: 'power3.inOut', duration: 1}})
                    .fromTo(cube, {
                        rotateY: -90
                    }, {
                        rotateY: 90,
                        ease: 'power1.inOut',
                        duration: 2
                    })
                    .fromTo(cube.querySelectorAll('.face'), {
                        color: (j) => 'hsl(' + (i/n*75+130) + ', 67%,' + (100*[rots[3].a, rots[0].a, rots[1].a][j]) + '%)'
                    }, {
                        color: (j) => 'hsl(' + (i/n*75+130) + ', 67%,' + (100*[rots[0].a, rots[1].a, rots[2].a][j]) + '%)'
                    }, 0)
                    .to(cube.querySelectorAll('.face'), {
                        color: (j) => 'hsl(' + (i/n*75+130) + ', 67%,' + (100*[rots[1].a, rots[2].a, rots[3].a][j]) + '%)'
                    }, 1)
                    .progress(i/n);
            }

            gsap.timeline()
                .from('.tray', {yPercent: -3, duration: 2, ease: 'power1.inOut', yoyo: true, repeat: -1}, 0)
                .fromTo('.tray', {rotate: -15}, {rotate: 15, duration: 4, ease: 'power1.inOut', yoyo: true, repeat: -1}, 0)
                .from('.die', {duration: 0.01, opacity: 0, stagger: {each: -0.05, ease: 'power1.in'}}, 0)
                .to('.tray', {scale: 1.2, duration: 2, ease: 'power3.inOut', yoyo: true, repeat: -1}, 0);

            const handleResize = () => {
                const h = n * 56;
                gsap.set('.tray', {height: h});
                gsap.set('.pov', {scale: innerHeight/h});
            };
            
            window.addEventListener('load', handleResize);
            window.addEventListener('resize', handleResize);
            
            // Logo and UI element animations
            if (isMobileDevice) {
                // 移动设备使用CSS过渡动画
                document.querySelector('.logo-container').classList.add('gsap-animation');
                document.querySelectorAll('.side-panel').forEach(panel => {
                    panel.classList.add('gsap-animation');
                    panel.style.transform = 'translateY(0)';
                    panel.style.opacity = '1';
                });
            } else {
                // 桌面设备使用完整GSAP动画
                gsap.from(".logo-container", {
                    y: -50,
                    opacity: 0,
                    duration: 1.2,
                    ease: "power3.out",
                    delay: 0.5,
                    onComplete: function() {
                        // Ensure logo is visible after animation
                        document.querySelector('.logo-container').style.opacity = 1;
                    }
                });
                
                // Side panel animations
                gsap.from([".left-panel", ".right-panel"], {
                    opacity: 0,
                    duration: 1.2,
                    ease: "power3.out",
                    delay: 0.8,
                    stagger: 0.2,
                    x: (i) => i === 0 ? -50 : 50,
                    onComplete: function() {
                        // Force panels to be visible after animation
                        document.querySelectorAll('.side-panel').forEach(panel => {
                            panel.style.opacity = 1;
                            panel.style.visibility = 'visible';
                        });
                    }
                });
            }

            // Ensure 3D animation doesn't overlap other elements
            const povElement = document.querySelector('.pov');
            if (povElement) {
                povElement.style.position = 'relative';
                povElement.style.zIndex = '5';
            }
        });
        
        // Copy contract address functionality
        function copyContractAddress(button) {
            const addressEl = button.closest('.contract-address');
            // 使用保存的完整地址（如果有）或当前文本
            const address = addressEl.getAttribute('data-full-address') || addressEl.textContent.trim();
            navigator.clipboard.writeText(address).then(() => {
                const toast = document.querySelector('.copy-toast');
                toast.classList.add('active');
                setTimeout(() => {
                    toast.classList.remove('active');
                }, 2000);
            });
        }
    </script>
    
    <!-- WebGL fluid background script -->
    <script>
        // Fluid simulation based on https://codepen.io/creativeocean/pen/ByBogvj
        
        const canvas = document.getElementById('webgl');
        const gl = canvas.getContext('webgl');
        
        // 检测WebGL支持情况
        if (!gl) {
            console.error('不支持WebGL。将使用备用背景。');
            document.body.style.background = 'linear-gradient(135deg, #050b10, #102030)';
            document.querySelector('.performance-indicator').style.display = 'block';
            document.querySelector('.performance-indicator').textContent = '不支持WebGL';
        }
        
        // 设置一个变量跟踪性能模式
        let isLowPerformanceMode = false;
        
        // Initialize full-screen canvas
        let width, height;
        function resizeCanvas() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
            
            if (gl) {
                // 根据性能模式调整分辨率
                const scaleFactor = isLowPerformanceMode ? 0.5 : 1.0;
                const scaledWidth = Math.floor(width * scaleFactor);
                const scaledHeight = Math.floor(height * scaleFactor);
                
                gl.viewport(0, 0, scaledWidth, scaledHeight);
                
                // 如果设备宽度小于600px，自动使用低性能模式
                if (width < 600 && !isLowPerformanceMode) {
                    isLowPerformanceMode = true;
                    document.querySelector('.performance-indicator').style.display = 'block';
                    document.querySelector('.performance-indicator').textContent = '移动设备优化模式';
                }
            }
        }
        
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        
        // 性能监控
        let frameCount = 0;
        let lastFrameTime = performance.now();
        let lowFrameRateCount = 0;
        
        function monitorPerformance() {
            frameCount++;
            
            const now = performance.now();
            const elapsed = now - lastFrameTime;
            
            if (elapsed >= 1000) { // 每秒检查一次
                const fps = Math.round((frameCount * 1000) / elapsed);
                frameCount = 0;
                lastFrameTime = now;
                
                // 如果帧率低于30FPS，增加低帧率计数
                if (fps < 30) {
                    lowFrameRateCount++;
                    
                    // 如果连续3次帧率低于30FPS，切换到低性能模式
                    if (lowFrameRateCount >= 3 && !isLowPerformanceMode) {
                        isLowPerformanceMode = true;
                        document.querySelector('.performance-indicator').style.display = 'block';
                        
                        // 如果帧率极低，完全禁用WebGL
                        if (fps < 15) {
                            document.getElementById('webgl').style.display = 'none';
                            document.body.style.background = 'linear-gradient(135deg, #050b10, #102030)';
                            document.querySelector('.performance-indicator').textContent = '低性能模式';
                        } else {
                            // 否则只是降低分辨率
                            resizeCanvas();
                            document.querySelector('.performance-indicator').textContent = '性能优化模式';
                        }
                    }
                } else {
                    // 帧率恢复正常，重置计数
                    lowFrameRateCount = Math.max(0, lowFrameRateCount - 1);
                }
            }
            
            requestAnimationFrame(monitorPerformance);
        }
        
        if (gl) {
            monitorPerformance();
        }
        
        // Create shader program
        function createShader(gl, type, source) {
            const shader = gl.createShader(type);
            gl.shaderSource(shader, source);
            gl.compileShader(shader);
            
            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
                console.error('Shader compilation error: ' + gl.getShaderInfoLog(shader));
                gl.deleteShader(shader);
                return null;
            }
            
            return shader;
        }
        
        // Vertex shader
        const vertexShaderSource = `
            attribute vec2 a_position;
            varying vec2 v_texCoord;
            
            void main() {
                v_texCoord = a_position * 0.5 + 0.5;
                gl_Position = vec4(a_position, 0.0, 1.0);
            }
        `;
        
        // Fragment shader - adjusted to darker tones to match cube animation
        const fragmentShaderSource = `
            precision highp float;
            varying vec2 v_texCoord;
            uniform float u_time;
            uniform vec2 u_resolution;
            uniform vec2 u_mouse;
            
            #define PI 3.14159265359
            
            // Noise function
            float random(vec2 st) {
                return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);
            }
            
            vec3 rgb2hsb(vec3 c) {
                vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
                vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
                vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));
                
                float d = q.x - min(q.w, q.y);
                float e = 1.0e-10;
                return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
            }
            
            vec3 hsb2rgb(vec3 c) {
                vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
                vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
                return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
            }
            
            void main() {
                vec2 st = v_texCoord;
                st.x *= u_resolution.x / u_resolution.y;
                
                vec2 mouse = u_mouse / u_resolution;
                mouse.x *= u_resolution.x / u_resolution.y;
                
                // Distortion effect
                float dist = distance(st, mouse);
                float angle = atan(st.y - mouse.y, st.x - mouse.x);
                
                float distortion = 0.0;
                if (dist < 0.3) {
                    distortion = (0.3 - dist) * 0.5;
                }
                
                // Time factor
                float t = u_time * 0.1; // Slow down animation speed
                
                // Distort coordinates
                vec2 distortedSt = st + vec2(
                    cos(angle) * distortion + cos(st.y * 5.0 + t) * 0.02,
                    sin(angle) * distortion + sin(st.x * 5.0 + t) * 0.02
                );
                
                // Create fluid colors - adjusted to match MPS theme
                float r = 0.2 + 0.2 * sin(distortedSt.x * 3.0 + t);
                float g = 0.05 + 0.1 * sin(distortedSt.y * 4.0 + t * 1.2);
                float b = 0.3 + 0.3 * sin((distortedSt.x + distortedSt.y) * 5.0 + t * 0.5);
                
                // Convert to HSB color space for better color mixing
                vec3 hsb = rgb2hsb(vec3(r, g, b));
                hsb.x = mod(hsb.x + 0.7 + t * 0.05, 1.0); // Adjust base hue
                hsb.y = 0.7 + 0.3 * sin(t * 0.2); // Saturation fluctuation
                hsb.z = 0.2 + 0.1 * sin(t * 0.3); // Lower brightness
                vec3 rgb = hsb2rgb(hsb);
                
                // Add noise texture
                float noise = random(distortedSt * 100.0) * 0.02;
                rgb += noise;
                
                gl_FragColor = vec4(rgb, 1.0);
            }
        `;
        
        if (gl) {
            // Create shader program
            const vertexShader = createShader(gl, gl.VERTEX_SHADER, vertexShaderSource);
            const fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSource);
            
            if (!vertexShader || !fragmentShader) {
                document.body.style.background = 'linear-gradient(135deg, #050b10, #102030)';
                document.querySelector('.performance-indicator').style.display = 'block';
                document.querySelector('.performance-indicator').textContent = 'Shader错误';
            } else {
                const program = gl.createProgram();
                gl.attachShader(program, vertexShader);
                gl.attachShader(program, fragmentShader);
                gl.linkProgram(program);
                
                if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
                    console.error('Program linking failed: ' + gl.getProgramInfoLog(program));
                    document.body.style.background = 'linear-gradient(135deg, #050b10, #102030)';
                    return;
                }
                
                // Create buffer
                const positionBuffer = gl.createBuffer();
                gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
                
                // Create a rectangle covering the entire canvas
                const positions = [
                    -1, -1,
                    1, -1,
                    -1, 1,
                    1, 1
                ];
                gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);
                
                // Get shader program variable locations
                const positionAttributeLocation = gl.getAttribLocation(program, 'a_position');
                const timeUniformLocation = gl.getUniformLocation(program, 'u_time');
                const resolutionUniformLocation = gl.getUniformLocation(program, 'u_resolution');
                const mouseUniformLocation = gl.getUniformLocation(program, 'u_mouse');
                
                // Enable vertex attributes
                gl.enableVertexAttribArray(positionAttributeLocation);
                gl.vertexAttribPointer(
                    positionAttributeLocation,
                    2,          // 2 values per vertex
                    gl.FLOAT,   // Data type
                    false,      // No normalization needed
                    0,          // Stride
                    0           // Offset
                );
                
                // Mouse interaction
                let mouseX = width / 2;
                let mouseY = height / 2;
                
                canvas.addEventListener('mousemove', (e) => {
                    mouseX = e.clientX;
                    mouseY = height - e.clientY; // Y-axis is bottom-up in WebGL
                });
                
                // Mobile device touch support
                canvas.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    mouseX = e.touches[0].clientX;
                    mouseY = height - e.touches[0].clientY;
                }, { passive: false });
                
                // Animation loop
                let startTime = Date.now();
                
                function render() {
                    // 如果切换到低性能模式，停止渲染
                    if (isLowPerformanceMode) return;
                    
                    const currentTime = (Date.now() - startTime) / 1000; // Convert to seconds
                    
                    gl.clearColor(0, 0, 0, 1);
                    gl.clear(gl.COLOR_BUFFER_BIT);
                    
                    // Use shader program
                    gl.useProgram(program);
                    
                    // Set uniforms
                    gl.uniform1f(timeUniformLocation, currentTime);
                    gl.uniform2f(resolutionUniformLocation, width, height);
                    gl.uniform2f(mouseUniformLocation, mouseX, mouseY);
                    
                    // Draw
                    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
                    
                    requestAnimationFrame(render);
                }
                
                render();
            }
        }
    </script>
    
    <!-- 页脚版权信息 -->
    <footer class="copyright-footer">
        <div class="copyright-text">
            Copyright © 2025 MPS Token. All Rights Reserved.
            <span class="license-text">MIT License</span>
        </div>
    </footer>
</body>
</html> 